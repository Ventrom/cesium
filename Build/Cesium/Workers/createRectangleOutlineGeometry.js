define(["./when-54c2dc71","./Cartesian2-15709417","./GeometryOffsetAttribute-b31a3ff4","./Transforms-c00dcfdd","./ComponentDatatype-a26dd044","./Check-6c0211bc","./GeometryAttribute-c2f3a6a0","./GeometryAttributes-4fcfcf40","./IndexDatatype-eaebd63b","./Math-fbfbe3b1","./PolygonPipeline-5326ae1a","./RectangleGeometryLibrary-af7be5c2","./RuntimeError-2109023a","./WebGLConstants-76bb35d1","./EllipsoidRhumbLine-281c49be"],function(h,d,y,b,E,p,A,w,G,m,R,P,e,t,i){"use strict";var v=new b.BoundingSphere,_=new b.BoundingSphere,D=new d.Cartesian3,L=new d.Rectangle;function C(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,l=r,u=2,s=0,d=4;n&&(u-=1,l-=1,s+=1,d-=2),o&&(u-=1,l-=1,s+=1,d-=2),s+=u*a+2*l-d;var p,c=new Float64Array(3*s),f=0,g=0,h=D;if(n)P.RectangleGeometryLibrary.computePosition(t,i,!1,g,0,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;else for(p=0;p<a;p++)P.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(p=a-1,g=1;g<r;g++)P.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;if(g=r-1,!o)for(p=a-2;0<=p;p--)P.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(p=0,g=r-2;0<g;g--)P.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(var y=c.length/3*2,b=G.IndexDatatype.createTypedArray(c.length/3,y),m=0,v=0;v<c.length/3-1;v++)b[m++]=v,b[m++]=v+1;b[m++]=c.length/3-1,b[m++]=0;var _=new A.Geometry({attributes:new w.GeometryAttributes,primitiveType:A.PrimitiveType.LINES});return _.attributes.position=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:c}),_.indices=b,_}function c(e){var t=(e=h.defaultValue(e,h.defaultValue.EMPTY_OBJECT)).rectangle,i=h.defaultValue(e.granularity,m.CesiumMath.RADIANS_PER_DEGREE),r=h.defaultValue(e.ellipsoid,d.Ellipsoid.WGS84),a=h.defaultValue(e.rotation,0);if(!h.defined(t))throw new p.DeveloperError("rectangle is required.");if(d.Rectangle.validate(t),t.north<t.south)throw new p.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var n=h.defaultValue(e.height,0),o=h.defaultValue(e.extrudedHeight,n);this._rectangle=d.Rectangle.clone(t),this._granularity=i,this._ellipsoid=r,this._surfaceHeight=Math.max(n,o),this._rotation=a,this._extrudedHeight=Math.min(n,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}c.packedLength=d.Rectangle.packedLength+d.Ellipsoid.packedLength+5,c.pack=function(e,t,i){if(!h.defined(e))throw new p.DeveloperError("value is required");if(!h.defined(t))throw new p.DeveloperError("array is required");return i=h.defaultValue(i,0),d.Rectangle.pack(e._rectangle,t,i),i+=d.Rectangle.packedLength,d.Ellipsoid.pack(e._ellipsoid,t,i),i+=d.Ellipsoid.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=h.defaultValue(e._offsetAttribute,-1),t};var f=new d.Rectangle,g=d.Ellipsoid.clone(d.Ellipsoid.UNIT_SPHERE),x={rectangle:f,ellipsoid:g,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};c.unpack=function(e,t,i){if(!h.defined(e))throw new p.DeveloperError("array is required");t=h.defaultValue(t,0);var r=d.Rectangle.unpack(e,t,f);t+=d.Rectangle.packedLength;var a=d.Ellipsoid.unpack(e,t,g);t+=d.Ellipsoid.packedLength;var n=e[t++],o=e[t++],l=e[t++],u=e[t++],s=e[t];return h.defined(i)?(i._rectangle=d.Rectangle.clone(r,i._rectangle),i._ellipsoid=d.Ellipsoid.clone(a,i._ellipsoid),i._surfaceHeight=o,i._rotation=l,i._extrudedHeight=u,i._offsetAttribute=-1===s?void 0:s,i):(x.granularity=n,x.height=o,x.rotation=l,x.extrudedHeight=u,x.offsetAttribute=-1===s?void 0:s,new c(x))};var H=new d.Cartographic;return c.createGeometry=function(e){var t,i,r=e._rectangle,a=e._ellipsoid,n=P.RectangleGeometryLibrary.computeOptions(r,e._granularity,e._rotation,0,L,H);if(!m.CesiumMath.equalsEpsilon(r.north,r.south,m.CesiumMath.EPSILON10)&&!m.CesiumMath.equalsEpsilon(r.east,r.west,m.CesiumMath.EPSILON10)){var o,l=e._surfaceHeight,u=e._extrudedHeight;if(!m.CesiumMath.equalsEpsilon(l,u,0,m.CesiumMath.EPSILON2)){if(t=function(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=C(e,t),u=t.height,s=t.width,d=R.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1),p=d.length,c=new Float64Array(2*p);c.set(d);var f=R.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a);c.set(f,p),l.attributes.position.values=c;var g=t.northCap,h=t.southCap,y=4;g&&(y-=1),h&&(y-=1);var b=2*(c.length/3+y),m=G.IndexDatatype.createTypedArray(c.length/3,b);p=c.length/6;for(var v,_=0,E=0;E<p-1;E++)m[_++]=E,m[_++]=E+1,m[_++]=E+p,m[_++]=E+p+1;if(m[_++]=p-1,m[_++]=0,m[_++]=p+p-1,m[_++]=p,m[_++]=0,m[_++]=p,g)v=u-1;else{var A=s-1;m[_++]=A,m[_++]=A+p,v=s+u-2}if(m[_++]=v,m[_++]=v+p,!h){var w=s+v-1;m[_++]=w,m[_]=w+p}return l.indices=m,l}(e,n),h.defined(e._offsetAttribute)){var s=t.attributes.position.values.length/3,d=new Uint8Array(s);d=e._offsetAttribute===y.GeometryOffsetAttribute.TOP?y.arrayFill(d,1,0,s/2):(o=e._offsetAttribute===y.GeometryOffsetAttribute.NONE?0:1,y.arrayFill(d,o)),t.attributes.applyOffset=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}var p=b.BoundingSphere.fromRectangle3D(r,a,l,_),c=b.BoundingSphere.fromRectangle3D(r,a,u,v);i=b.BoundingSphere.union(p,c)}else{if((t=C(e,n)).attributes.position.values=R.PolygonPipeline.scaleToGeodeticHeight(t.attributes.position.values,l,a,!1),h.defined(e._offsetAttribute)){var f=t.attributes.position.values.length,g=new Uint8Array(f/3);o=e._offsetAttribute===y.GeometryOffsetAttribute.NONE?0:1,y.arrayFill(g,o),t.attributes.applyOffset=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:g})}i=b.BoundingSphere.fromRectangle3D(r,a,l)}return new A.Geometry({attributes:t.attributes,indices:t.indices,primitiveType:A.PrimitiveType.LINES,boundingSphere:i,offsetAttribute:e._offsetAttribute})}},function(e,t){return h.defined(t)&&(e=c.unpack(e,t)),e._ellipsoid=d.Ellipsoid.clone(e._ellipsoid),e._rectangle=d.Rectangle.clone(e._rectangle),c.createGeometry(e)}});
//# sourceMappingURL=createRectangleOutlineGeometry.js.map

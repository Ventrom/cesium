define(["exports","./GeometryOffsetAttribute-b31a3ff4","./Transforms-c00dcfdd","./Cartesian2-15709417","./ComponentDatatype-a26dd044","./when-54c2dc71","./Check-6c0211bc","./GeometryAttribute-c2f3a6a0","./GeometryAttributes-4fcfcf40","./IndexDatatype-eaebd63b","./Math-fbfbe3b1","./VertexFormat-4d8b817a"],function(e,ue,le,fe,ce,de,d,pe,Ce,ye,he,p){"use strict";var ve=new fe.Cartesian3,_e=new fe.Cartesian3,be=new fe.Cartesian3,Ae=new fe.Cartesian3,xe=new fe.Cartesian3,l=new fe.Cartesian3(1,1,1),we=Math.cos,ke=Math.sin;function C(e){e=de.defaultValue(e,de.defaultValue.EMPTY_OBJECT);var t=de.defaultValue(e.radii,l),a=de.defaultValue(e.innerRadii,t),r=de.defaultValue(e.minimumClock,0),i=de.defaultValue(e.maximumClock,he.CesiumMath.TWO_PI),n=de.defaultValue(e.minimumCone,0),o=de.defaultValue(e.maximumCone,he.CesiumMath.PI),m=Math.round(de.defaultValue(e.stackPartitions,64)),s=Math.round(de.defaultValue(e.slicePartitions,64)),u=de.defaultValue(e.vertexFormat,p.VertexFormat.DEFAULT);if(s<3)throw new d.DeveloperError("options.slicePartitions cannot be less than three.");if(m<3)throw new d.DeveloperError("options.stackPartitions cannot be less than three.");this._radii=fe.Cartesian3.clone(t),this._innerRadii=fe.Cartesian3.clone(a),this._minimumClock=r,this._maximumClock=i,this._minimumCone=n,this._maximumCone=o,this._stackPartitions=m,this._slicePartitions=s,this._vertexFormat=p.VertexFormat.clone(u),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}C.packedLength=2*fe.Cartesian3.packedLength+p.VertexFormat.packedLength+7,C.pack=function(e,t,a){if(!de.defined(e))throw new d.DeveloperError("value is required");if(!de.defined(t))throw new d.DeveloperError("array is required");return a=de.defaultValue(a,0),fe.Cartesian3.pack(e._radii,t,a),a+=fe.Cartesian3.packedLength,fe.Cartesian3.pack(e._innerRadii,t,a),a+=fe.Cartesian3.packedLength,p.VertexFormat.pack(e._vertexFormat,t,a),a+=p.VertexFormat.packedLength,t[a++]=e._minimumClock,t[a++]=e._maximumClock,t[a++]=e._minimumCone,t[a++]=e._maximumCone,t[a++]=e._stackPartitions,t[a++]=e._slicePartitions,t[a]=de.defaultValue(e._offsetAttribute,-1),t};var t,y=new fe.Cartesian3,h=new fe.Cartesian3,v=new p.VertexFormat,_={radii:y,innerRadii:h,vertexFormat:v,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};C.unpack=function(e,t,a){if(!de.defined(e))throw new d.DeveloperError("array is required");t=de.defaultValue(t,0);var r=fe.Cartesian3.unpack(e,t,y);t+=fe.Cartesian3.packedLength;var i=fe.Cartesian3.unpack(e,t,h);t+=fe.Cartesian3.packedLength;var n=p.VertexFormat.unpack(e,t,v);t+=p.VertexFormat.packedLength;var o=e[t++],m=e[t++],s=e[t++],u=e[t++],l=e[t++],f=e[t++],c=e[t];return de.defined(a)?(a._radii=fe.Cartesian3.clone(r,a._radii),a._innerRadii=fe.Cartesian3.clone(i,a._innerRadii),a._vertexFormat=p.VertexFormat.clone(n,a._vertexFormat),a._minimumClock=o,a._maximumClock=m,a._minimumCone=s,a._maximumCone=u,a._stackPartitions=l,a._slicePartitions=f,a._offsetAttribute=-1===c?void 0:c,a):(_.minimumClock=o,_.maximumClock=m,_.minimumCone=s,_.maximumCone=u,_.stackPartitions=l,_.slicePartitions=f,_.offsetAttribute=-1===c?void 0:c,new C(_))},C.createGeometry=function(e){var t=e._radii;if(!(t.x<=0||t.y<=0||t.z<=0)){var a=e._innerRadii;if(!(a.x<=0||a.y<=0||a.z<=0)){var r,i,n=e._minimumClock,o=e._maximumClock,m=e._minimumCone,s=e._maximumCone,u=e._vertexFormat,l=e._slicePartitions+1,f=e._stackPartitions+1;(l=Math.round(l*Math.abs(o-n)/he.CesiumMath.TWO_PI))<2&&(l=2),(f=Math.round(f*Math.abs(s-m)/he.CesiumMath.PI))<2&&(f=2);var c=0,d=[m],p=[n];for(r=0;r<f;r++)d.push(m+r*(s-m)/(f-1));for(d.push(s),i=0;i<l;i++)p.push(n+i*(o-n)/(l-1));p.push(o);var C=d.length,y=p.length,h=0,v=1,_=a.x!==t.x||a.y!==t.y||a.z!==t.z,b=!1,A=!1,x=!1;_&&(v=2,0<m&&(b=!0,h+=l-1),s<Math.PI&&(A=!0,h+=l-1),(o-n)%he.CesiumMath.TWO_PI?(x=!0,h+=2*(f-1)+1):h+=1);var w=y*C*v,k=new Float64Array(3*w),P=ue.arrayFill(new Array(w),!1),F=ue.arrayFill(new Array(w),!1),g=l*f*v,V=6*(g+h+1-(l+f)*v),D=ye.IndexDatatype.createTypedArray(g,V),M=u.normal?new Float32Array(3*w):void 0,T=u.tangent?new Float32Array(3*w):void 0,E=u.bitangent?new Float32Array(3*w):void 0,G=u.st?new Float32Array(2*w):void 0,L=new Array(C),O=new Array(C);for(r=0;r<C;r++)L[r]=ke(d[r]),O[r]=we(d[r]);var I=new Array(y),z=new Array(y);for(i=0;i<y;i++)z[i]=we(p[i]),I[i]=ke(p[i]);for(r=0;r<C;r++)for(i=0;i<y;i++)k[c++]=t.x*L[r]*z[i],k[c++]=t.y*L[r]*I[i],k[c++]=t.z*O[r];var N,R,U,S,B=w/2;if(_)for(r=0;r<C;r++)for(i=0;i<y;i++)k[c++]=a.x*L[r]*z[i],k[c++]=a.y*L[r]*I[i],k[c++]=a.z*O[r],P[B]=!0,0<r&&r!==C-1&&0!==i&&i!==y-1&&(F[B]=!0),B++;for(c=0,r=1;r<C-2;r++)for(N=r*y,R=(r+1)*y,i=1;i<y-2;i++)D[c++]=R+i,D[c++]=R+i+1,D[c++]=N+i+1,D[c++]=R+i,D[c++]=N+i+1,D[c++]=N+i;if(_){var W=C*y;for(r=1;r<C-2;r++)for(N=W+r*y,R=W+(r+1)*y,i=1;i<y-2;i++)D[c++]=R+i,D[c++]=N+i,D[c++]=N+i+1,D[c++]=R+i,D[c++]=N+i+1,D[c++]=R+i+1}if(_){if(b)for(S=C*y,r=1;r<y-2;r++)D[c++]=r,D[c++]=r+1,D[c++]=S+r+1,D[c++]=r,D[c++]=S+r+1,D[c++]=S+r;if(A)for(U=C*y-y,S=C*y*v-y,r=1;r<y-2;r++)D[c++]=U+r+1,D[c++]=U+r,D[c++]=S+r,D[c++]=U+r+1,D[c++]=S+r,D[c++]=S+r+1}if(x){for(r=1;r<C-2;r++)S=y*C+y*r,U=y*r,D[c++]=S,D[c++]=U+y,D[c++]=U,D[c++]=S,D[c++]=S+y,D[c++]=U+y;for(r=1;r<C-2;r++)S=y*C+y*(r+1)-1,U=y*(r+1)-1,D[c++]=U+y,D[c++]=S,D[c++]=U,D[c++]=U+y,D[c++]=S+y,D[c++]=S}var q=new Ce.GeometryAttributes;u.position&&(q.position=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:k}));var Y,J=0,X=0,Z=0,j=0,H=w/2,K=fe.Ellipsoid.fromCartesian3(t),Q=fe.Ellipsoid.fromCartesian3(a);if(u.st||u.normal||u.tangent||u.bitangent){for(r=0;r<w;r++){Y=P[r]?Q:K;var $=fe.Cartesian3.fromArray(k,3*r,ve),ee=Y.geodeticSurfaceNormal($,_e);if(F[r]&&fe.Cartesian3.negate(ee,ee),u.st){var te=fe.Cartesian2.negate(ee,xe);G[J++]=Math.atan2(te.y,te.x)/he.CesiumMath.TWO_PI+.5,G[J++]=Math.asin(ee.z)/Math.PI+.5}if(u.normal&&(M[X++]=ee.x,M[X++]=ee.y,M[X++]=ee.z),u.tangent||u.bitangent){var ae,re=be,ie=0;if(P[r]&&(ie=H),ae=!b&&ie<=r&&r<ie+2*y?fe.Cartesian3.UNIT_X:fe.Cartesian3.UNIT_Z,fe.Cartesian3.cross(ae,ee,re),fe.Cartesian3.normalize(re,re),u.tangent&&(T[Z++]=re.x,T[Z++]=re.y,T[Z++]=re.z),u.bitangent){var ne=fe.Cartesian3.cross(ee,re,Ae);fe.Cartesian3.normalize(ne,ne),E[j++]=ne.x,E[j++]=ne.y,E[j++]=ne.z}}}u.st&&(q.st=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:G})),u.normal&&(q.normal=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:M})),u.tangent&&(q.tangent=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:T})),u.bitangent&&(q.bitangent=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:E}))}if(de.defined(e._offsetAttribute)){var oe=k.length,me=new Uint8Array(oe/3),se=e._offsetAttribute===ue.GeometryOffsetAttribute.NONE?0:1;ue.arrayFill(me,se),q.applyOffset=new pe.GeometryAttribute({componentDatatype:ce.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:me})}return new pe.Geometry({attributes:q,indices:D,primitiveType:pe.PrimitiveType.TRIANGLES,boundingSphere:le.BoundingSphere.fromEllipsoid(K),offsetAttribute:e._offsetAttribute})}}},C.getUnitEllipsoid=function(){return de.defined(t)||(t=C.createGeometry(new C({radii:new fe.Cartesian3(1,1,1),vertexFormat:p.VertexFormat.POSITION_ONLY}))),t},e.EllipsoidGeometry=C});
//# sourceMappingURL=EllipsoidGeometry-8f202aa1.js.map

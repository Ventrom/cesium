define(["./when-54c2dc71","./Cartesian2-15709417","./ArcType-dc1c5aee","./GeometryOffsetAttribute-b31a3ff4","./Transforms-c00dcfdd","./Check-6c0211bc","./ComponentDatatype-a26dd044","./EllipsoidTangentPlane-989039a6","./GeometryAttribute-c2f3a6a0","./GeometryAttributes-4fcfcf40","./GeometryInstance-2f94f67c","./GeometryPipeline-31fd0b9c","./IndexDatatype-eaebd63b","./Math-fbfbe3b1","./PolygonGeometryLibrary-6a01edff","./PolygonPipeline-5326ae1a","./RuntimeError-2109023a","./WebGLConstants-76bb35d1","./IntersectionTests-9d9af9db","./Plane-ff99a7c3","./AttributeCompression-42df7d39","./EncodedCartesian3-8590615c","./arrayRemoveDuplicates-b5ccac6b","./EllipsoidRhumbLine-281c49be"],function(v,c,E,A,G,f,_,T,H,L,C,O,D,I,w,x,e,t,i,r,o,n,a,y){"use strict";var k=[],S=[];function R(e,t,i,r,o){var n,a,y=T.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,k);x.PolygonPipeline.computeWindingOrder2D(y)===x.WindingOrder.CLOCKWISE&&(y.reverse(),t=t.slice().reverse());var s=t.length,l=0;if(r)for(n=new Float64Array(2*s*3),a=0;a<s;a++){var p=t[a],u=t[(a+1)%s];n[l++]=p.x,n[l++]=p.y,n[l++]=p.z,n[l++]=u.x,n[l++]=u.y,n[l++]=u.z}else{var d=0;if(o===E.ArcType.GEODESIC)for(a=0;a<s;a++)d+=w.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%s],i);else if(o===E.ArcType.RHUMB)for(a=0;a<s;a++)d+=w.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%s],i);for(n=new Float64Array(3*d),a=0;a<s;a++){var c;o===E.ArcType.GEODESIC?c=w.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%s],i,S):o===E.ArcType.RHUMB&&(c=w.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%s],i,S));for(var f=c.length,h=0;h<f;++h)n[l++]=c[h]}}var g=2*(s=n.length/3),m=D.IndexDatatype.createTypedArray(s,g);for(a=l=0;a<s-1;a++)m[l++]=a,m[l++]=a+1;return m[l++]=s-1,m[l++]=0,new C.GeometryInstance({geometry:new H.Geometry({attributes:new L.GeometryAttributes({position:new H.GeometryAttribute({componentDatatype:_.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:m,primitiveType:H.PrimitiveType.LINES})})}function M(e,t,i,r,o){var n,a,y=T.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,k);x.PolygonPipeline.computeWindingOrder2D(y)===x.WindingOrder.CLOCKWISE&&(y.reverse(),t=t.slice().reverse());var s=t.length,l=new Array(s),p=0;if(r)for(n=new Float64Array(2*s*3*2),a=0;a<s;++a){l[a]=p/3;var u=t[a],d=t[(a+1)%s];n[p++]=u.x,n[p++]=u.y,n[p++]=u.z,n[p++]=d.x,n[p++]=d.y,n[p++]=d.z}else{var c=0;if(o===E.ArcType.GEODESIC)for(a=0;a<s;a++)c+=w.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%s],i);else if(o===E.ArcType.RHUMB)for(a=0;a<s;a++)c+=w.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%s],i);for(n=new Float64Array(3*c*2),a=0;a<s;++a){var f;l[a]=p/3,o===E.ArcType.GEODESIC?f=w.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%s],i,S):o===E.ArcType.RHUMB&&(f=w.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%s],i,S));for(var h=f.length,g=0;g<h;++g)n[p++]=f[g]}}s=n.length/6;var m=l.length,b=2*(2*s+m),P=D.IndexDatatype.createTypedArray(s+m,b);for(a=p=0;a<s;++a)P[p++]=a,P[p++]=(a+1)%s,P[p++]=a+s,P[p++]=(a+1)%s+s;for(a=0;a<m;a++){var v=l[a];P[p++]=v,P[p++]=v+s}return new C.GeometryInstance({geometry:new H.Geometry({attributes:new L.GeometryAttributes({position:new H.GeometryAttribute({componentDatatype:_.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:P,primitiveType:H.PrimitiveType.LINES})})}function h(e){if(f.Check.typeOf.object("options",e),f.Check.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),e.perPositionHeight&&v.defined(e.height))throw new f.DeveloperError("Cannot use both options.perPositionHeight and options.height");if(v.defined(e.arcType)&&e.arcType!==E.ArcType.GEODESIC&&e.arcType!==E.ArcType.RHUMB)throw new f.DeveloperError("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var t=e.polygonHierarchy,i=v.defaultValue(e.ellipsoid,c.Ellipsoid.WGS84),r=v.defaultValue(e.granularity,I.CesiumMath.RADIANS_PER_DEGREE),o=v.defaultValue(e.perPositionHeight,!1),n=o&&v.defined(e.extrudedHeight),a=v.defaultValue(e.arcType,E.ArcType.GEODESIC),y=v.defaultValue(e.height,0),s=v.defaultValue(e.extrudedHeight,y);if(!n){var l=Math.max(y,s);s=Math.min(y,s),y=l}this._ellipsoid=c.Ellipsoid.clone(i),this._granularity=r,this._height=y,this._extrudedHeight=s,this._arcType=a,this._polygonHierarchy=t,this._perPositionHeight=o,this._perPositionHeightExtrude=n,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=w.PolygonGeometryLibrary.computeHierarchyPackedLength(t)+c.Ellipsoid.packedLength+8}h.pack=function(e,t,i){return f.Check.typeOf.object("value",e),f.Check.defined("array",t),i=v.defaultValue(i,0),i=w.PolygonGeometryLibrary.packPolygonHierarchy(e._polygonHierarchy,t,i),c.Ellipsoid.pack(e._ellipsoid,t,i),i+=c.Ellipsoid.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=v.defaultValue(e._offsetAttribute,-1),t[i]=e.packedLength,t};var g=c.Ellipsoid.clone(c.Ellipsoid.UNIT_SPHERE),m={polygonHierarchy:{}};return h.unpack=function(e,t,i){f.Check.defined("array",e),t=v.defaultValue(t,0);var r=w.PolygonGeometryLibrary.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var o=c.Ellipsoid.unpack(e,t,g);t+=c.Ellipsoid.packedLength;var n=e[t++],a=e[t++],y=e[t++],s=1===e[t++],l=1===e[t++],p=e[t++],u=e[t++],d=e[t];return v.defined(i)||(i=new h(m)),i._polygonHierarchy=r,i._ellipsoid=c.Ellipsoid.clone(o,i._ellipsoid),i._height=n,i._extrudedHeight=a,i._granularity=y,i._perPositionHeight=l,i._perPositionHeightExtrude=s,i._arcType=p,i._offsetAttribute=-1===u?void 0:u,i.packedLength=d,i},h.fromPositions=function(e){return e=v.defaultValue(e,v.defaultValue.EMPTY_OBJECT),f.Check.defined("options.positions",e.positions),new h({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},h.createGeometry=function(e){var t=e._ellipsoid,i=e._granularity,r=e._polygonHierarchy,o=e._perPositionHeight,n=e._arcType,a=w.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(r,!o,t);if(0!==a.length){var y,s,l,p=[],u=I.CesiumMath.chordLength(i,t.maximumRadius),d=e._height,c=e._extrudedHeight;if(e._perPositionHeightExtrude||!I.CesiumMath.equalsEpsilon(d,c,0,I.CesiumMath.EPSILON2))for(l=0;l<a.length;l++){if((y=M(t,a[l],u,o,n)).geometry=w.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(y.geometry,d,c,t,o),v.defined(e._offsetAttribute)){var f=y.geometry.attributes.position.values.length/3,h=new Uint8Array(f);h=e._offsetAttribute===A.GeometryOffsetAttribute.TOP?A.arrayFill(h,1,0,f/2):(s=e._offsetAttribute===A.GeometryOffsetAttribute.NONE?0:1,A.arrayFill(h,s)),y.geometry.attributes.applyOffset=new H.GeometryAttribute({componentDatatype:_.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}p.push(y)}else for(l=0;l<a.length;l++){if((y=R(t,a[l],u,o,n)).geometry.attributes.position.values=x.PolygonPipeline.scaleToGeodeticHeight(y.geometry.attributes.position.values,d,t,!o),v.defined(e._offsetAttribute)){var g=y.geometry.attributes.position.values.length,m=new Uint8Array(g/3);s=e._offsetAttribute===A.GeometryOffsetAttribute.NONE?0:1,A.arrayFill(m,s),y.geometry.attributes.applyOffset=new H.GeometryAttribute({componentDatatype:_.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}p.push(y)}var b=O.GeometryPipeline.combineInstances(p)[0],P=G.BoundingSphere.fromVertices(b.attributes.position.values);return new H.Geometry({attributes:b.attributes,indices:b.indices,primitiveType:b.primitiveType,boundingSphere:P,offsetAttribute:e._offsetAttribute})}},function(e,t){return v.defined(t)&&(e=h.unpack(e,t)),e._ellipsoid=c.Ellipsoid.clone(e._ellipsoid),h.createGeometry(e)}});
//# sourceMappingURL=createPolygonOutlineGeometry.js.map
